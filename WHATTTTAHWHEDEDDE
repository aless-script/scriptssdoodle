local function CheckMatch(wildDoodle)
    if not wildDoodle then return false, "No Doodle" end
    
    local failReasons = {}
    local hasAnyFilter = false
    
    -- Check species
    if Settings.TargetSpecies ~= "" then
        hasAnyFilter = true
        local name = (wildDoodle.Name or wildDoodle.RealName or ""):lower()
        local target = Settings.TargetSpecies:lower()
        if not name:find(target, 1, true) then
            table.insert(failReasons, "Wrong Species")
        end
    end
    
    -- Check stars
    if Settings.MinStars > 0 then
        hasAnyFilter = true
        local stars = wildDoodle.Star or 0
        if stars < Settings.MinStars then
            table.insert(failReasons, "Low Stars (" .. stars .. "/" .. Settings.MinStars .. ")")
        end
    end
    
    -- Check misprint
    if Settings.OnlyMisprint then
        hasAnyFilter = true
        local isMisprint = wildDoodle.Shiny or (wildDoodle.Color and wildDoodle.Color ~= "Normal")
        if not isMisprint then
            table.insert(failReasons, "Not Misprint")
        end
    end
    
    -- Check hidden trait
    if Settings.OnlyHiddenTrait then
        hasAnyFilter = true
        if not wildDoodle.HiddenTrait then
            table.insert(failReasons, "No Hidden Trait")
        end
    end
    
    -- Check specific ability
    if Settings.TargetAbility ~= "" then
        hasAnyFilter = true
        local ability = wildDoodle.Ability or wildDoodle.AbilityName or ""
        local targetAbility = Settings.TargetAbility:lower()
        if ability:lower() ~= targetAbility then
            table.insert(failReasons, "Wrong Ability (" .. ability .. ")")
        end
    end
    
    -- Check gender
    if Settings.TargetGender ~= "Any" then
        hasAnyFilter = true
        local gender = wildDoodle.Gender or "Unknown"
        if gender ~= Settings.TargetGender then
            table.insert(failReasons, "Wrong Gender (" .. gender .. ")")
        end
    end
    
    -- Check skin
    if Settings.TargetSkin ~= "Any" then
        hasAnyFilter = true
        local skin = wildDoodle.Skin or wildDoodle.SkinName or "Default"
        if Settings.TargetSkin == "Default" then
            if skin ~= "Default" and skin ~= "" then
                table.insert(failReasons, "Has Skin (" .. skin .. ")")
            end
        elseif Settings.TargetSkin == "HasSkin" then
            if skin == "Default" or skin == "" then
                table.insert(failReasons, "No Skin")
            end
        else
            local targetSkin = Settings.TargetSkin:lower()
            if skin:lower() ~= targetSkin then
                table.insert(failReasons, "Wrong Skin (" .. skin .. ")")
            end
        end
    end
    
    -- If no filters are set, warn the user
    if not hasAnyFilter then
        return false, "⚠️ NO FILTERS SET - Set at least one filter!"
    end
    
    -- ALL conditions must pass
    if #failReasons > 0 then
        return false, table.concat(failReasons, ", ")
    end
    
    return true, "✅ ALL CONDITIONS MET!"
end
